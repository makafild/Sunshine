<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sunshine: Troubleshooting</title>
<link rel="icon" href="sunshine.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Sunshine"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxyconfig.css" rel="stylesheet" type="text/css"/>
<link href="doc-styles.css" rel="stylesheet" type="text/css"/>
<!--FONTAWESOME START-->
<link href="assets/fontawesome/css/all.min.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="assets/fontawesome/js/all.min.js"></script>
<!--FONTAWESOME END-->
<!--DOXYGEN-AWESOME START-->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="doxyconfig-readthedocs-search.js"></script>
<script type="text/javascript">
  DoxygenAwesomeDarkModeToggle.init()
  DoxygenAwesomeFragmentCopyButton.init()
  DoxygenAwesomeParagraphLink.init()
  DoxygenAwesomeInteractiveToc.init()
  DoxygenAwesomeTabs.init()
  ReadtheDocsSearch.init()
</script>
<!--DOXYGEN-AWESOME END-->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="sunshine.png"/></td>
  <td id="projectalign">
   <div id="projectname">Sunshine
   </div>
   <div id="projectbrief">Self-hosted game stream host for Moonlight.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.html','Search',true);
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_docs_2troubleshooting.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Troubleshooting</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#general-1">General</a>
    <ul>
      <li class="level2">
        <a href="#forgotten-credentials">Forgotten Credentials</a>
      </li>
      <li class="level2">
        <a href="#unusual-mouse-behavior">Unusual Mouse Behavior</a>
      </li>
      <li class="level2">
        <a href="#web-ui-access">Web UI Access</a>
      </li>
      <li class="level2">
        <a href="#controller-works-on-steam-but-not-in-games">Controller works on Steam but not in games</a>
      </li>
      <li class="level2">
        <a href="#network-performance-test">Network performance test</a>
      </li>
      <li class="level2">
        <a href="#packet-loss-buffer-overrun">Packet loss (Buffer overrun)</a>
      </li>
      <li class="level2">
        <a href="#packet-loss-mtu">Packet loss (MTU)</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#linux-3">Linux</a>
    <ul>
      <li class="level2">
        <a href="#hardware-encoding-fails">Hardware Encoding fails</a>
      </li>
      <li class="level2">
        <a href="#input-not-working">Input not working</a>
      </li>
      <li class="level2">
        <a href="#kms-streaming-fails">KMS Streaming fails</a>
      </li>
      <li class="level2">
        <a href="#kms-streaming-fails-on-nvidia-gpus">KMS streaming fails on Nvidia GPUs</a>
      </li>
      <li class="level2">
        <a href="#amd-encoding-latency-issues">AMD encoding latency issues</a>
      </li>
      <li class="level2">
        <a href="#gamescope-compatibility">Gamescope compatibility</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#macos-3">macOS</a>
    <ul>
      <li class="level2">
        <a href="#dynamic-session-lookup-failed">Dynamic session lookup failed</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#windows-3">Windows</a>
    <ul>
      <li class="level2">
        <a href="#no-gamepad-detected">No gamepad detected</a>
      </li>
      <li class="level2">
        <a href="#permission-denied">Permission denied</a>
      </li>
      <li class="level2">
        <a href="#stuttering">Stuttering</a>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="troubleshooting"></a></p>
<h1><a class="anchor" id="general-1"></a>
General</h1>
<h2><a class="anchor" id="forgotten-credentials"></a>
Forgotten Credentials</h2>
<p>If you forgot your credentials to the web UI, try this.</p>
<p> <div class="tabbed"><ul>@ilinebr  <li><b class="tab-title">@ilinebr General @ilinebr  </b>@ilinebr <code>bash sunshine --creds {new-username} {new-password} </code> @ilinebr  </li>  <li><b class="tab-title">@ilinebr AppImage @ilinebr  </b>@ilinebr <code>bash ./sunshine.AppImage --creds {new-username} {new-password} </code> @ilinebr  </li>  <li><b class="tab-title">@ilinebr Flatpak @ilinebr  </b>@ilinebr <code>bash flatpak run --command=sunshine dev.lizardbyte.app.Sunshine --creds {new-username} {new-password} </code> @ilinebr  </li> @ilinebr  </ul></div><br></p>
<p>@tip{Don't forget to replace <code>{new-username}</code> and <code>{new-password}</code> with your new credentials. Do not include the curly braces.}</p>
<h2><a class="anchor" id="unusual-mouse-behavior"></a>
Unusual Mouse Behavior</h2>
<p>If you experience unusual mouse behavior, try attaching a physical mouse to the Sunshine host.</p>
<h2><a class="anchor" id="web-ui-access"></a>
Web UI Access</h2>
<p>Can't access the web UI?</p>
<ol type="1">
<li>Check firewall rules.</li>
</ol>
<h2><a class="anchor" id="controller-works-on-steam-but-not-in-games"></a>
Controller works on Steam but not in games</h2>
<p>One trick might be to change Steam settings and check or uncheck the configuration to support Xbox/Playstation controllers and leave only support for Generic controllers.</p>
<p>Also, if you have many controllers already directly connected to the host, it might help to disable them so that the Sunshine provided controller (connected to the guest) is the "first" one. In Linux this can be accomplished on USB devices by finding the device in <code>/sys/bus/usb/devices/</code> and writing <code>0</code> to the <code>authorized</code> file.</p>
<h2><a class="anchor" id="network-performance-test"></a>
Network performance test</h2>
<p>For real-time game streaming the most important characteristic of the network path between server and client is not pure bandwidth but rather stability and consistency (low latency with low variance, minimal or no packet loss).</p>
<p>The network can be tested using the multi-platform tool <a href="https://iperf.fr">iPerf3</a>.</p>
<p>On the Sunshine host <code>iperf3</code> is started in server mode:</p>
<div class="fragment"><div class="line">iperf3 -s</div>
</div><!-- fragment --><p>On the client device iperf3 is asked to perform a 60-second UDP test in reverse direction (from server to client) at a given bitrate (e.g. 50 Mbps):</p>
<div class="fragment"><div class="line">iperf3 -c {HostIpAddress} -t 60 -u -R -b 50M</div>
</div><!-- fragment --><p>Watch the output on the client for packet loss and jitter values. Both should be (very) low. Ideally packet loss remains less than 5% and jitter below 1ms.</p>
<p>For Android clients use <a href="https://play.google.com/store/apps/details?id=com.appplanex.pingmasternetworktools">PingMaster</a>.</p>
<p>For iOS clients use <a href="https://apps.apple.com/us/app/he-net-network-tools/id858241710">HE.NET Network Tools</a>.</p>
<p>If you are testing a remote connection (over the internet) you will need to forward the port 5201 (TCP and UDP) from your host.</p>
<h2><a class="anchor" id="packet-loss-buffer-overrun"></a>
Packet loss (Buffer overrun)</h2>
<p>If the host PC (running Sunshine) has a much faster connection to the network than the slowest segment of the network path to the client device (running Moonlight), massive packet loss can occur: Sunshine emits its stream in bursts every 16ms (for 60fps) but those bursts can't be passed on fast enough to the client and must be buffered by one of the network devices inbetween. If the bitrate is high enough, these buffers will overflow and data will be discarded.</p>
<p>This can easily happen if e.g. the host has a 2.5 Gbit/s connection and the client only 1 Gbit/s or Wi-Fi. Similarly, a 1 Gbps host may be too fast for a client having only a 100 Mbps interface.</p>
<p>As a workaround the transmission speed of the host NIC can be reduced: 1 Gbps instead of 2.5 or 100 Mbps instead of 1 Gbps. (A technically more advanced solution would be to configure traffic shaping rules at the OS-level, so that only Sunshine's traffic is slowed down.)</p>
<p>Sunshine versions &gt; 0.23.1 include improved networking code that should alleviate or even solve this issue (without reducing the NIC speed).</p>
<h2><a class="anchor" id="packet-loss-mtu"></a>
Packet loss (MTU)</h2>
<p>Although unlikely, some guests might work better with a lower <a href="https://en.wikipedia.org/wiki/Maximum_transmission_unit">MTU</a> from the host. For example, a LG TV was found to have 30-60% packet loss when the host had MTU set to 1500 and 1472, but 0% packet loss with a MTU of 1428 set in the network card serving the stream (a Linux PC). It's unclear how that helped precisely, so it's a last resort suggestion.</p>
<h1><a class="anchor" id="linux-3"></a>
Linux</h1>
<h2><a class="anchor" id="hardware-encoding-fails"></a>
Hardware Encoding fails</h2>
<p>Due to legal concerns, Mesa has disabled hardware decoding and encoding by default.</p>
<div class="fragment"><div class="line">Error: Could not open codec [h264_vaapi]: Function not implemented</div>
</div><!-- fragment --><p>If you see the above error in the Sunshine logs, compiling <em>Mesa</em> manually, may be required. See the official Mesa3D <a href="https://docs.mesa3d.org/install.html">Compiling and Installing</a> documentation for instructions.</p>
<dl class="section important"><dt>Important</dt><dd>{You must re-enable the disabled encoders. You can do so, by passing the following argument to the build system. You may also want to enable decoders, however that is not required for Sunshine and is not covered here. <div class="fragment"><div class="line">-Dvideo-codecs=h264enc,h265enc</div>
</div><!-- fragment --> }</dd></dl>
<h2><a class="anchor" id="input-not-working"></a>
Input not working</h2>
<p>After installation, the <code>udev</code> rules need to be reloaded. Our post-install script tries to do this for you automatically, but if it fails you may need to restart your system.</p>
<p>If the input is still not working, you may need to add your user to the <code>input</code> group.</p>
<div class="fragment"><div class="line">sudo usermod -aG input $USER</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>{Other build options are listed in the <a href="https://gitlab.freedesktop.org/mesa/mesa/-/blob/main/meson_options.txt">meson options</a> file.}</dd></dl>
<h2><a class="anchor" id="kms-streaming-fails"></a>
KMS Streaming fails</h2>
<p>If screencasting fails with KMS, you may need to run the following to force unprivileged screencasting.</p>
<div class="fragment"><div class="line">sudo setcap -r $(readlink -f $(which sunshine))</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>{The above command will not work with the AppImage or Flatpak packages. Please refer to the <a class="el" href="md_docs_2getting__started.html#appimage">AppImage setup</a> or <a class="el" href="md_docs_2getting__started.html#flatpak">Flatpak setup</a> for more specific instructions.}</dd></dl>
<h2><a class="anchor" id="kms-streaming-fails-on-nvidia-gpus"></a>
KMS streaming fails on Nvidia GPUs</h2>
<p>If KMS screen capture results in a black screen being streamed, you may need to set the parameter <code>modeset=1</code> for Nvidia's kernel module. This can be done by adding the following directive to the kernel command line:</p>
<div class="fragment"><div class="line">nvidia_drm.modeset=1</div>
</div><!-- fragment --><p>Consult your distribution's documentation for details on how to do this. (Most often grub is used to load the kernel and set its command line.)</p>
<h2><a class="anchor" id="amd-encoding-latency-issues"></a>
AMD encoding latency issues</h2>
<p>If you notice unexpectedly high encoding latencies (e.g. in Moonlight's performance overlay) or strong fluctuations thereof, your system's Mesa libraries are outdated (&lt;24.2). This is particularly problematic at higher resolutions (4K).</p>
<p>Starting with Mesa-24.2 applications can request a <a href="https://gitlab.freedesktop.org/mesa/mesa/-/merge_requests/30039">low-latency mode</a> by running them with a special <a href="https://docs.mesa3d.org/envvars.html#envvar-AMD_DEBUG">environment variable</a>: </p><div class="fragment"><div class="line">export AMD_DEBUG=lowlatencyenc</div>
</div><!-- fragment --><p> Sunshine sets this variable automatically, no manual configuration is needed.</p>
<p>To check whether low-latency mode is being used, one can watch the VCLK and DCLK frequencies in amdgpu_top. Without this encoder tuning both clock frequencies will fluctuate strongly, whereas with active low-latency encoding they will stay high as long as the encoder is used.</p>
<h2><a class="anchor" id="gamescope-compatibility"></a>
Gamescope compatibility</h2>
<p>Some users have reported stuttering issues when streaming games running within Gamescope.</p>
<h1><a class="anchor" id="macos-3"></a>
macOS</h1>
<h2><a class="anchor" id="dynamic-session-lookup-failed"></a>
Dynamic session lookup failed</h2>
<p>If you get this error:</p>
<blockquote class="doxtable">
<p>Dynamic session lookup supported but failed: launchd did not provide a socket path, verify that org.freedesktop.dbus-session.plist is loaded! </p>
</blockquote>
<p>Try this. </p><div class="fragment"><div class="line">launchctl load -w /Library/LaunchAgents/org.freedesktop.dbus-session.plist</div>
</div><!-- fragment --><h1><a class="anchor" id="windows-3"></a>
Windows</h1>
<h2><a class="anchor" id="no-gamepad-detected"></a>
No gamepad detected</h2>
<p>Verify that you've installed <a href="https://github.com/nefarius/ViGEmBus/releases/latest">Nefarius Virtual Gamepad</a>.</p>
<h2><a class="anchor" id="permission-denied"></a>
Permission denied</h2>
<p>Since Sunshine runs as a service on Windows, it may not have the same level of access that your regular user account has. You may get permission denied errors when attempting to launch a game or application from a non system drive.</p>
<p>You will need to modify the security permissions on your disk. Ensure that user/principal SYSTEM has full permissions on the disk.</p>
<h2><a class="anchor" id="stuttering"></a>
Stuttering</h2>
<p>If you experience stuttering using NVIDIA, try disabling <code>vsync:fast</code> in the NVIDIA Control Panel.</p>
<div class="section_buttons"></div><div class="section_buttons"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Previous   </th><th class="markdownTableHeadRight">Next    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="md_docs_2api.html">API</a>   </td><td class="markdownTableBodyRight"><a class="el" href="md_docs_2building.html">Building</a>   </td></tr>
</table>
</div><div class="section_buttons"></div><details  style="display: none;">
<summary >
</summary>
<p></p>
<p></p>
</details>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
