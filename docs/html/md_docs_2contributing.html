<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sunshine: Contributing</title>
<link rel="icon" href="sunshine.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Sunshine"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxyconfig.css" rel="stylesheet" type="text/css"/>
<link href="doc-styles.css" rel="stylesheet" type="text/css"/>
<!--FONTAWESOME START-->
<link href="assets/fontawesome/css/all.min.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="assets/fontawesome/js/all.min.js"></script>
<!--FONTAWESOME END-->
<!--DOXYGEN-AWESOME START-->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="doxyconfig-readthedocs-search.js"></script>
<script type="text/javascript">
  DoxygenAwesomeDarkModeToggle.init()
  DoxygenAwesomeFragmentCopyButton.init()
  DoxygenAwesomeParagraphLink.init()
  DoxygenAwesomeInteractiveToc.init()
  DoxygenAwesomeTabs.init()
  ReadtheDocsSearch.init()
</script>
<!--DOXYGEN-AWESOME END-->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="sunshine.png"/></td>
  <td id="projectalign">
   <div id="projectname">Sunshine
   </div>
   <div id="projectbrief">Self-hosted game stream host for Moonlight.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.html','Search',true);
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_docs_2contributing.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Contributing</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#recommended-tools">Recommended Tools</a>
  </li>
  <li class="level1">
    <a href="#project-patterns">Project Patterns</a>
    <ul>
      <li class="level2">
        <a href="#web-ui">Web UI</a>
        <ul>
          <li class="level3">
            <a href="#building-1">Building</a>
          </li>
        </ul>
      </li>
      <li class="level2">
        <a href="#localization">Localization</a>
        <ul>
          <li class="level3">
            <a href="#crowdin-1">CrowdIn</a>
            <ul>
              <li class="level4">
                <a href="#translation-basics">Translation Basics</a>
              </li>
              <li class="level4">
                <a href="#crowdin-integration">CrowdIn Integration</a>
              </li>
            </ul>
          </li>
          <li class="level3">
            <a href="#extraction">Extraction</a>
            <ul>
              <li class="level4">
                <a href="#web-ui-1">Web UI</a>
              </li>
              <li class="level4">
                <a href="#c">C++</a>
              </li>
            </ul>
          </li>
        </ul>
      </li>
      <li class="level2">
        <a href="#testing">Testing</a>
        <ul>
          <li class="level3">
            <a href="#clang-format">Clang Format</a>
          </li>
          <li class="level3">
            <a href="#unit-testing">Unit Testing</a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="contributing"></a></p>
<p>Read our contribution guide in our organization level <a href="https://docs.lizardbyte.dev/latest/developers/contributing.html">docs</a>.</p>
<h1><a class="anchor" id="recommended-tools"></a>
Recommended Tools</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Tool   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="https://www.jetbrains.com/clion/"><img src="https://resources.jetbrains.com/storage/products/company/brand/logos/CLion_icon.svg" alt="" width="30" height="30" style="pointer-events: none;" class="inline"/></a><br  />
CLion   </td><td class="markdownTableBodyNone">Recommended IDE for C++ development. Free licenses available for open source developers through the <a href="https://www.jetbrains.com/community/opensource/">JetBrains Open Source Program</a>.   </td></tr>
</table>
<h1><a class="anchor" id="project-patterns"></a>
Project Patterns</h1>
<h2><a class="anchor" id="web-ui"></a>
Web UI</h2>
<ul>
<li>The Web UI uses <a href="https://vitejs.dev">Vite</a> as its build system.</li>
<li>The HTML pages used by the Web UI are found in <code>./src_assets/common/assets/web</code>.</li>
<li><a href="https://www.npmjs.com/package/vite-plugin-ejs">EJS</a> is used as a templating system for the pages (check <code>template_header.html</code> and <code>template_header_main.html</code>).</li>
<li>The Style System is provided by <a href="https://getbootstrap.com">Bootstrap</a>.</li>
<li>The JS framework used by the more interactive pages is <a href="https://vuejs.org">Vus.js</a>.</li>
</ul>
<h3><a class="anchor" id="building-1"></a>
Building</h3>
<p> <div class="tabbed"><ul>@ilinebr  <li><b class="tab-title">@ilinebr CMake @ilinebr  </b>@ilinebr <code>bash cmake -B build -G Ninja -S . --target web-ui ninja -C build web-ui </code>@ilinebr  </li>  <li><b class="tab-title">@ilinebr Manual @ilinebr  </b>@ilinebr <code>bash npm run dev </code>@ilinebr  </li> @ilinebr  </ul></div><br></p>
<h2><a class="anchor" id="localization"></a>
Localization</h2>
<p>Sunshine and related LizardByte projects are being localized into various languages. The default language is <code>en</code> (English).</p>
<p><img src="https://app.lizardbyte.dev/dashboard/crowdin/LizardByte_graph.svg" alt="" style="pointer-events: none;" class="inline"/></p>
<p>@admonition{Community | We are looking for language coordinators to help approve translations. The goal is to have the bars above filled with green! If you are interesting, please reach out to us on our Discord server.}</p>
<h3><a class="anchor" id="crowdin-1"></a>
CrowdIn</h3>
<p>The translations occur on <a href="https://translate.lizardbyte.dev">CrowdIn</a>. Anyone is free to contribute to the localization there.</p>
<h4><a class="anchor" id="translation-basics"></a>
Translation Basics</h4>
<ul>
<li>The brand names <em>LizardByte</em> and <em>Sunshine</em> should never be translated.</li>
<li>Other brand names should never be translated. Examples include <em>AMD</em>, <em>Intel</em>, and <em>NVIDIA</em>.</li>
</ul>
<h4><a class="anchor" id="crowdin-integration"></a>
CrowdIn Integration</h4>
<p>How does it work?</p>
<p>When a change is made to Sunshine source code, a workflow generates new translation templates that get pushed to CrowdIn automatically.</p>
<p>When translations are updated on CrowdIn, a push gets made to the <em>l10n_master</em> branch and a PR is made against the <em>master</em> branch. Once the PR is merged, all updated translations are part of the project and will be included in the next release.</p>
<h3><a class="anchor" id="extraction"></a>
Extraction</h3>
<h4><a class="anchor" id="web-ui-1"></a>
Web UI</h4>
<p>Sunshine uses <a href="https://vue-i18n.intlify.dev">Vue I18n</a> for localizing the UI. The following is a simple example of how to use it.</p>
<ul>
<li><p class="startli">Add the string to the <code>./src_assets/common/assets/web/public/assets/locale/en.json</code> file, in English. </p><div class="fragment"><div class="line">{</div>
<div class="line"> &quot;index&quot;: {</div>
<div class="line">   &quot;welcome&quot;: &quot;Hello, Sunshine!&quot;</div>
<div class="line"> }</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>{The json keys should be sorted alphabetically. You can use <a href="https://novicelab.org/jsonabc">jsonabc</a> to sort the keys.}</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>{Due to the integration with Crowdin, it is important to only add strings to the <em>en.json</em> file, and to not modify any other language files. After the PR is merged, the translations can take place on <a href="https://translate.lizardbyte.dev">CrowdIn</a>. Once the translations are complete, a PR will be made to merge the translations into Sunshine.}</dd></dl>
</li>
<li><p class="startli">Use the string in the Vue component. </p><div class="fragment"><div class="line">&lt;template&gt;</div>
<div class="line">  &lt;div&gt;</div>
<div class="line">    &lt;p&gt;{{ $t(&#39;index.welcome&#39;) }}&lt;/p&gt;</div>
<div class="line">  &lt;/div&gt;</div>
<div class="line">&lt;/template&gt;</div>
</div><!-- fragment --><p class="startli">@tip{More formatting examples can be found in the <a href="https://kazupon.github.io/vue-i18n/guide/formatting.html">Vue I18n guide</a>.}</p>
</li>
</ul>
<h4><a class="anchor" id="c"></a>
C++</h4>
<p>There should be minimal cases where strings need to be extracted from C++ source code; however it may be necessary in some situations. For example the system tray icon could be localized as it is user interfacing.</p>
<ul>
<li>Wrap the string to be extracted in a function as shown. <div class="fragment"><div class="line"><span class="preprocessor">#include &lt;boost/locale.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line">std::string msg = boost::locale::translate(<span class="stringliteral">&quot;Hello world!&quot;</span>);</div>
</div><!-- fragment --></li>
</ul>
<p>@tip{More examples can be found in the documentation for <a href="https://www.boost.org/doc/libs/1_70_0/libs/locale/doc/html/messages_formatting.html">boost locale</a>.}</p>
<dl class="section warning"><dt>Warning</dt><dd>{The below is for information only. Contributors should never include manually updated template files, or manually compiled language files in Pull Requests.}</dd></dl>
<p>Strings are automatically extracted from the code to the <code>locale/sunshine.po</code> template file. The generated file is used by CrowdIn to generate language specific template files. The file is generated using the <code>.github/workflows/localize.yml</code> workflow and is run on any push event into the <code>master</code> branch. Jobs are only run if any of the following paths are modified.</p>
<div class="fragment"><div class="line">- &#39;src/**&#39;</div>
</div><!-- fragment --><p>When testing locally it may be desirable to manually extract, initialize, update, and compile strings. Python is required for this, along with the python dependencies in the <code>./scripts/requirements.txt</code> file. Additionally, <a href="https://www.gnu.org/software/gettext">xgettext</a> must be installed.</p>
<ul>
<li>Extract, initialize, and update <div class="fragment"><div class="line">python ./scripts/_locale.py --extract --init --update</div>
</div><!-- fragment --></li>
<li>Compile <div class="fragment"><div class="line">python ./scripts/_locale.py --compile</div>
</div><!-- fragment --></li>
</ul>
<dl class="section attention"><dt>Attention</dt><dd>{Due to the integration with CrowdIn, it is important to not include any extracted or compiled files in Pull Requests. The files are automatically generated and updated by the workflow. Once the PR is merged, the translations can take place on <a href="https://translate.lizardbyte.dev">CrowdIn</a>. Once the translations are complete, a PR will be made to merge the translations into Sunshine.}</dd></dl>
<h2><a class="anchor" id="testing"></a>
Testing</h2>
<h3><a class="anchor" id="clang-format"></a>
Clang Format</h3>
<p>Source code is tested against the <code>.clang-format</code> file for linting errors. The workflow file responsible for clang format testing is <code>.github/workflows/cpp-clang-format-lint.yml</code>.</p>
<p>Option 1: </p><div class="fragment"><div class="line">find ./ -iname *.cpp -o -iname *.h -iname *.m -iname *.mm | xargs clang-format -i</div>
</div><!-- fragment --><p>Option 2 (will modify files): </p><div class="fragment"><div class="line">python ./scripts/update_clang_format.py</div>
</div><!-- fragment --><h3><a class="anchor" id="unit-testing"></a>
Unit Testing</h3>
<p>Sunshine uses <a href="https://github.com/google/googletest">Google Test</a> for unit testing. Google Test is included in the repo as a submodule. The test sources are located in the <code>./tests</code> directory.</p>
<p>The tests need to be compiled into an executable, and then run. The tests are built using the normal build process, but can be disabled by setting the <code>BUILD_TESTS</code> CMake option to <code>OFF</code>.</p>
<p>To run the tests, execute the following command.</p>
<div class="fragment"><div class="line">./build/tests/test_sunshine</div>
</div><!-- fragment --><p>To see all available options, run the tests with the <code>--help</code> flag.</p>
<div class="fragment"><div class="line">./build/tests/test_sunshine --help</div>
</div><!-- fragment --><p>@tip{See the googletest <a href="https://google.github.io/googletest/faq.html">FAQ</a> for more information on how to use Google Test.}</p>
<p>We use <a href="https://www.gcovr.com">gcovr</a> to generate code coverage reports, and <a href="https://about.codecov.io">Codecov</a> to analyze the reports for all PRs and commits.</p>
<p>Codecov will fail a PR if the total coverage is reduced too much, or if not enough of the diff is covered by tests. In some cases, the code cannot be covered when running the tests inside of GitHub runners. For example, any test that needs access to the GPU will not be able to run. In these cases, the coverage can be omitted by adding comments to the code. See the <a href="https://gcovr.com/en/stable/guide/exclusion-markers.html#exclusion-markers">gcovr documentation</a> for more information.</p>
<p>Even if your changes cannot be covered in the CI, we still encourage you to write the tests for them. This will allow maintainers to run the tests locally.</p>
<div class="section_buttons"></div><div class="section_buttons"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Previous   </th><th class="markdownTableHeadRight">Next    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="md_docs_2building.html">Building</a>   </td><td class="markdownTableBodyRight"><a class="el" href="md_third-party_2doxyconfig_2docs_2source__code.html">Source Code</a>   </td></tr>
</table>
</div><div class="section_buttons"></div><details  style="display: none;">
<summary >
</summary>
<p></p>
<p></p>
</details>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
