<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sunshine: crypto::cipher::gcm_t Class Reference</title>
<link rel="icon" href="sunshine.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Sunshine"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxyconfig.css" rel="stylesheet" type="text/css"/>
<link href="doc-styles.css" rel="stylesheet" type="text/css"/>
<!--FONTAWESOME START-->
<link href="assets/fontawesome/css/all.min.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="assets/fontawesome/js/all.min.js"></script>
<!--FONTAWESOME END-->
<!--DOXYGEN-AWESOME START-->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="doxyconfig-readthedocs-search.js"></script>
<script type="text/javascript">
  DoxygenAwesomeDarkModeToggle.init()
  DoxygenAwesomeFragmentCopyButton.init()
  DoxygenAwesomeParagraphLink.init()
  DoxygenAwesomeInteractiveToc.init()
  DoxygenAwesomeTabs.init()
  ReadtheDocsSearch.init()
</script>
<!--DOXYGEN-AWESOME END-->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="sunshine.png"/></td>
  <td id="projectalign">
   <div id="projectname">Sunshine
   </div>
   <div id="projectbrief">Self-hosted game stream host for Moonlight.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.html','Search',true);
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classcrypto_1_1cipher_1_1gcm__t.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classcrypto_1_1cipher_1_1gcm__t-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">crypto::cipher::gcm_t Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for crypto::cipher::gcm_t:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classcrypto_1_1cipher_1_1gcm__t__inherit__graph.svg" width="166" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for crypto::cipher::gcm_t:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classcrypto_1_1cipher_1_1gcm__t__coll__graph.svg" width="100%" height="364"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af5a4080d1914f4eed75d7f9b1f6d256d" id="r_af5a4080d1914f4eed75d7f9b1f6d256d"><td class="memItemLeft" align="right" valign="top"><a id="af5a4080d1914f4eed75d7f9b1f6d256d" name="af5a4080d1914f4eed75d7f9b1f6d256d"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>decrypt</b> (const std::string_view &amp;cipher, std::vector&lt; std::uint8_t &gt; &amp;plaintext, aes_t *iv)</td></tr>
<tr class="separator:af5a4080d1914f4eed75d7f9b1f6d256d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a595f79509ff80b4db67db826d219d732" id="r_a595f79509ff80b4db67db826d219d732"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a595f79509ff80b4db67db826d219d732">encrypt</a> (const std::string_view &amp;plaintext, std::uint8_t *tag, std::uint8_t *ciphertext, aes_t *iv)</td></tr>
<tr class="memdesc:a595f79509ff80b4db67db826d219d732"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts the plaintext using AES GCM mode.  <br /></td></tr>
<tr class="separator:a595f79509ff80b4db67db826d219d732"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58e22faf9e81d658e83cd22aec055745" id="r_a58e22faf9e81d658e83cd22aec055745"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a58e22faf9e81d658e83cd22aec055745">encrypt</a> (const std::string_view &amp;plaintext, std::uint8_t *tagged_cipher, aes_t *iv)</td></tr>
<tr class="memdesc:a58e22faf9e81d658e83cd22aec055745"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts the plaintext using AES GCM mode. length of cipher must be at least: round_to_pkcs7_padded(plaintext.size()) + crypto::cipher::tag_size.  <br /></td></tr>
<tr class="separator:a58e22faf9e81d658e83cd22aec055745"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace712961d73c524d934c4a1ba97a8b1e" id="r_ace712961d73c524d934c4a1ba97a8b1e"><td class="memItemLeft" align="right" valign="top"><a id="ace712961d73c524d934c4a1ba97a8b1e" name="ace712961d73c524d934c4a1ba97a8b1e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>gcm_t</b> (const crypto::aes_t &amp;key, bool padding=true)</td></tr>
<tr class="separator:ace712961d73c524d934c4a1ba97a8b1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3c4e0a1ea8c0db10aa7cedd8dd9f39a" id="r_ac3c4e0a1ea8c0db10aa7cedd8dd9f39a"><td class="memItemLeft" align="right" valign="top"><a id="ac3c4e0a1ea8c0db10aa7cedd8dd9f39a" name="ac3c4e0a1ea8c0db10aa7cedd8dd9f39a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>gcm_t</b> (<a class="el" href="classcrypto_1_1cipher_1_1gcm__t.html">gcm_t</a> &amp;&amp;) noexcept=default</td></tr>
<tr class="separator:ac3c4e0a1ea8c0db10aa7cedd8dd9f39a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a84b99783f09aeaf6147dffd397aa96" id="r_a3a84b99783f09aeaf6147dffd397aa96"><td class="memItemLeft" align="right" valign="top"><a id="a3a84b99783f09aeaf6147dffd397aa96" name="a3a84b99783f09aeaf6147dffd397aa96"></a>
<a class="el" href="classcrypto_1_1cipher_1_1gcm__t.html">gcm_t</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (<a class="el" href="classcrypto_1_1cipher_1_1gcm__t.html">gcm_t</a> &amp;&amp;) noexcept=default</td></tr>
<tr class="separator:a3a84b99783f09aeaf6147dffd397aa96"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_attribs_classcrypto_1_1cipher_1_1cipher__t"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_attribs_classcrypto_1_1cipher_1_1cipher__t')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classcrypto_1_1cipher_1_1cipher__t.html">crypto::cipher::cipher_t</a></td></tr>
<tr class="memitem:a01a92a451c715d914368cc34b1d48078 inherit pub_attribs_classcrypto_1_1cipher_1_1cipher__t" id="r_a01a92a451c715d914368cc34b1d48078"><td class="memItemLeft" align="right" valign="top">
<a class="el" href="classutil_1_1uniq__ptr.html">cipher_ctx_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>decrypt_ctx</b></td></tr>
<tr class="separator:a01a92a451c715d914368cc34b1d48078 inherit pub_attribs_classcrypto_1_1cipher_1_1cipher__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af789258d9f707f23e1c0e364c448dbec inherit pub_attribs_classcrypto_1_1cipher_1_1cipher__t" id="r_af789258d9f707f23e1c0e364c448dbec"><td class="memItemLeft" align="right" valign="top">
<a class="el" href="classutil_1_1uniq__ptr.html">cipher_ctx_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>encrypt_ctx</b></td></tr>
<tr class="separator:af789258d9f707f23e1c0e364c448dbec inherit pub_attribs_classcrypto_1_1cipher_1_1cipher__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addbb52889e36b3bb1b4dd8481f09e09d inherit pub_attribs_classcrypto_1_1cipher_1_1cipher__t" id="r_addbb52889e36b3bb1b4dd8481f09e09d"><td class="memItemLeft" align="right" valign="top">
aes_t&#160;</td><td class="memItemRight" valign="bottom"><b>key</b></td></tr>
<tr class="separator:addbb52889e36b3bb1b4dd8481f09e09d inherit pub_attribs_classcrypto_1_1cipher_1_1cipher__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf069d5288955df1b8ff9fea9d26084a inherit pub_attribs_classcrypto_1_1cipher_1_1cipher__t" id="r_aaf069d5288955df1b8ff9fea9d26084a"><td class="memItemLeft" align="right" valign="top">
bool&#160;</td><td class="memItemRight" valign="bottom"><b>padding</b></td></tr>
<tr class="separator:aaf069d5288955df1b8ff9fea9d26084a inherit pub_attribs_classcrypto_1_1cipher_1_1cipher__t"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a595f79509ff80b4db67db826d219d732" name="a595f79509ff80b4db67db826d219d732"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a595f79509ff80b4db67db826d219d732">&#9670;&#160;</a></span>encrypt() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypto::cipher::gcm_t::encrypt </td>
          <td>(</td>
          <td class="paramtype">const std::string_view &amp;</td>          <td class="paramname"><span class="paramname"><em>plaintext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::uint8_t *</td>          <td class="paramname"><span class="paramname"><em>tag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::uint8_t *</td>          <td class="paramname"><span class="paramname"><em>ciphertext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">aes_t *</td>          <td class="paramname"><span class="paramname"><em>iv</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts the plaintext using AES GCM mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">plaintext</td><td>The plaintext data to be encrypted. </td></tr>
    <tr><td class="paramname">tag</td><td>The buffer where the GCM tag will be written. </td></tr>
    <tr><td class="paramname">ciphertext</td><td>The buffer where the resulting ciphertext will be written. </td></tr>
    <tr><td class="paramname">iv</td><td>The initialization vector to be used for the encryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The total length of the ciphertext and GCM tag. Returns -1 in case of an error.</dd></dl>
<p>This function encrypts the given plaintext using the AES key in GCM mode. The initialization vector (IV) is also provided. The function handles the creation and initialization of the encryption context, and manages the encryption process. The resulting ciphertext and the GCM tag are written into the tagged_cipher buffer. </p>

</div>
</div>
<a id="a58e22faf9e81d658e83cd22aec055745" name="a58e22faf9e81d658e83cd22aec055745"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58e22faf9e81d658e83cd22aec055745">&#9670;&#160;</a></span>encrypt() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypto::cipher::gcm_t::encrypt </td>
          <td>(</td>
          <td class="paramtype">const std::string_view &amp;</td>          <td class="paramname"><span class="paramname"><em>plaintext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::uint8_t *</td>          <td class="paramname"><span class="paramname"><em>tagged_cipher</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">aes_t *</td>          <td class="paramname"><span class="paramname"><em>iv</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts the plaintext using AES GCM mode. length of cipher must be at least: round_to_pkcs7_padded(plaintext.size()) + crypto::cipher::tag_size. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">plaintext</td><td>The plaintext data to be encrypted. </td></tr>
    <tr><td class="paramname">tagged_cipher</td><td>The buffer where the resulting ciphertext and GCM tag will be written. </td></tr>
    <tr><td class="paramname">iv</td><td>The initialization vector to be used for the encryption. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The total length of the ciphertext and GCM tag written into tagged_cipher. Returns -1 in case of an error. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="crypto_8h_source.html">crypto.h</a></li>
<li>src/<a class="el" href="crypto_8cpp.html">crypto.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>crypto</b></li><li class="navelem"><b>cipher</b></li><li class="navelem"><a class="el" href="classcrypto_1_1cipher_1_1gcm__t.html">gcm_t</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
